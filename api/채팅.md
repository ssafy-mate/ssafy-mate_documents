# 채팅 API

## 채팅방 목록 불러오기

| TYPE |           URL           | TOKEN |
| :--: | :---------------------: | :---: |
| GET  | /api/chat/room/{userId} |   O   |

### Request

- url 

### Response

- 채팅 목록 불러오기 성공(목록이 있는 경우)

```json
{
  "roomList": [
    {
      "roomId": "1-2",
      "userId": 1,
      "userName": "조원빈",
      "profileImgUrl": "/src/main/~~~",
      "content": "안녕하세요",
      "sentTime": "2022-01-17T17:03:36.336763"
    },
    {
      "roomId": "1-2",
      "userId": 2,
      "userName": "",
      "profileImgUrl": "/src/main/~~~",
      "content": "안녕하세요",
      "sentTime": "2022-01-17T17:03:26.336763"
    }
  ]
}
```

> userId는 상대방 아이디

- 채팅 목록 불러오기 성공(목록이 없는 경우)

```json
{
  "roomList": []
}
```

- 채팅 목록 불러오기 실패

```json
{
  "status": 401,
  "success": false,
  "message": "인증에 실패했습니다."
}
```

## 메세지 보내기

| TYPE |      URL      | TOKEN |
| :--: | :-----------: | :---: |
| POST | /api/chat |   X   |

- 프론트엔드 : 채팅용 서버 주소에 대한 axios instance 생성
- 백엔드 : 기존 서버와 분리된 채팅용 포트 생성 

### Request
```json
{
  "roomId" : "1-2",
  "senderId" : 1,
  "content" : "안녕하세요",
  "sentTime": "2022-01-17T17:03:36.336763"
}
```

### Response
```json
{
  "roomId": "1-2",
  "senderId": 1,
  "sentTime": "2022-01-17T17:03:37.336763",
  "content": "안녕하세요."
}
```

## 대화 내용 불러오기

| TYPE |      URL      | TOKEN |
| :--: | :-----------: | :---: |
| GET  | /api/chat/log/{roomId} |   O   |

### Request

```json
{
  "nowPage": 1,
  "entryTime": "2022-01-17T17:03:49.336763"
}
```

- nowPage는 요청하는 페이지(1이 최신)
- entryTime은 처음 사용자가 대화 내용을 요청한 시간(바뀌지 않음)
- 토큰은 nowPage가 1일 때만 받음


### Response

- 채팅방에 입장하는 경우 대화 내용 불러오기 성공(페이징 처리)

```json
{
  "contentList": [
    {
      "id": 14,
      "content": "추가 데이터11",
      "userName": "손영배",
      "sentTime": "2022-01-17T17:03:48.336763",
      "senderId": 1
    },
    {
      "id": 13,
      "content": "추가 데이터11",
      "userName": "조원빈",
      "sentTime": "2022-01-17T17:03:47.336763",
      "senderId": 2
    },
    {
      "id": 12,
      "content": "추가 데이터11",
      "userName": "손영배",
      "sentTime": "2022-01-17T17:03:46.336763",
      "senderId": 1
    },
    {
      "id": 11,
      "content": "추가 데이터11",
      "userName": "조원빈",
      "sentTime": "2022-01-17T17:03:45.336763",
      "senderId": 2
    },
    {
      "id": 10,
      "content": "추가 데이터10",
      "userName": "손영배",
      "sentTime": "2022-01-17T17:03:44.336763",
      "senderId": 1
    }
  ],
  "totalPages": 3
}
```

> id가 큰 것이 최신
> nowPage : 1 을 요청했을 때만 totalPages를 넘겨줌.

- 페이징 요청한 경우 대화 내용 불러오기 성공(페이징 처리)

```json
{
  "contentList": [
    {
      "id": 9,
      "content": "추가 데이터9",
      "userName": "조원빈",
      "sentTime": "2022-01-17T17:03:43.336763",
      "senderId": 2
    },
    {
      "id": 8,
      "content": "추가 데이터8",
      "userName": "손영배",
      "sentTime": "2022-01-17T17:03:42.336763",
      "senderId": 1
    },
    {
      "id": 7,
      "content": "추가 데이터7",
      "userName": "조원빈",
      "sentTime": "2022-01-17T17:03:41.336763",
      "senderId": 2
    },
    {
      "id": 6,
      "content": "추가 데이터6",
      "userName": "조원빈",
      "sentTime": "2022-01-17T17:03:40.336763",
      "senderId": 2
    },
    {
      "id": 5,
      "content": "추가 데이터5",
      "userName": "조원빈",
      "sentTime": "2022-01-17T17:03:39.336763",
      "senderId": 2
    }
  ]
}
```

- 대화 내용이 없는 경우

```json
{
  "contentList": [],
  "totalPages": 0
}
```
